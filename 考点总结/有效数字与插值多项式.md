[TOC]



##  考点1--误差分析和有效数字判别

### 绝对误差

$$
x^*是准确值x的一个近似值，则称 \\
e=x-x^*为x^*的绝对误差 \\
|e|的一个上界\varepsilon^*称作近似值的误差限
$$

>1. 误差限一般为某位的半个单位
>2. 如刻度尺测量时，误差限即为测量精度的1/2
>3. 四舍五入时，绝对误差限为近似值末位的半个单位

### 相对误差

$$
e_r=\frac{x-x^*}{x}，因为x未知，一般用 \\
e_r=\frac{e}{x^*}来进行替代，一般用百分比来进行表示
$$

### 有效数字

若近似值 x ^*^的误差限是某一位的半个单位 ，设该位到 x ^*^的第一位非零数字共有 n 位 ，则称 x ^*^ 有 n位**有效数字**。
$$
x^*存在n位有效数字时，写作标准化形式为：\\
x^*=\pm{a_1a_2a_3\cdots a_n}\times10^{m},a_1\neq0,m为整数\\
此时相对误差限可表示为:\\
\varepsilon_r^*\le \frac{1}{2a_1}\times10^{-(n-1)} \\
相反的，若x^*的相对误差限为：\varepsilon_r^*\le \frac{1}{2(a_1+1)}\times10^{-(n-1)}\\
则称x^*至少具有n位有效数字
$$

>1. 已知有效数字位数，反求相对误差限时，常取a~1~ =1的情况来表示最不利的情况
>2. 已知相对误差限，反推有效数字的至少位数时，常取a~1~=9的情况来反推

## 考点2--插值法获取插值多项式

重点是Lagrange插值法和Newton差商形式下的差值公式，以及Hermite的三点三次插值与Newton插值的关系！

### Lagrange插值法

$$
插值函数L_n(x)=\sum_{i=0}^{n}l_i(x)y_i \\
其中l_i(x) = \prod_{j\neq i\space j=0}^{n} \frac{(x-x_j)}{(x_i-x_j)} \\
l_i(x_j)=\delta_j=\left \{ \begin{array}{a} 1,&i=j& \\
0,&i\neq j&\end{array} \right.
$$

特别的就有：

一点零次插值多项式：
$$
L_n(x)=y_0
$$
两点一次插值多项式：
$$
L_1(x)=\frac{x-x_1}{x_0-x_1}y_0+\frac{x-x_0}{x_1-x_0}y_1
$$
**三点两次插值多项式**（这个的计算量考察概率比较大）：
$$
L_2(x)=\frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)}y_0+\frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)}y_1+\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)}y_2
$$
**插值余项**

**举例计算Lagrange插值公式**

|  k   | x~k~ | f(x~k~) |
| :--: | :--: | :-----: |
|  0   |  0   |    3    |
|  1   |  1   |    3    |
|  2   | 3/2  |  13/4   |
|  3   |  2   |   5/3   |

本题是一个四点三次的Lagrange插值多项式
$$
L_3(x)&=&\frac{(x-x_1)(x-x_2)(x-x_3)}{(x_0-x_1)(x_0-x_2)(x_0-x_3)}y_0+\frac{(x-x_0)(x-x_2)(x-x_3)}{(x_1-x_0)(x_1-x_2(x_1-x_3)}y_1\\
&+&\frac{(x-x_0)(x-x_1)(x-x_3)}{(x_2-x_0)(x_2-x_1)(x_2-x_3)}y_2 + \frac{(x-x0)(x-x_1)(x-x_2)}{(x_3-x_0)(x_3-x_1)(x_3-x_2)}y_3 \\
&=&\frac{(x-1)(x-\frac{3}{2})(x-2)}{(-1)(-\frac{3}{2})(-2)}*3+\frac{x(x-\frac{3}{2})(x-2)}{1(-\frac{1}{2})(-1)}*3+\frac{x(x-1)(x-2)}{\frac{3}{2}\frac{1}{2}(-\frac{1}{2})}\frac{13}{4} + \frac{x(x-1)(x-\frac{3}{2})}{2\cdot1\cdot \frac{1}{2}}\frac{5}{3} \\
&=&-(x-1)(x-\frac{3}{2})(x-2)+6x(x-\frac{3}{2})(x-2)-\frac{26}{3}x(x-1)(x-2)+\frac{5}{3}x(x-1)(x-\frac{3}{2}) \\
&=& -2x^3+\frac{16}{3}x^2-\frac{10}{3}x+3
$$


### Newton插值公式（差商形式）

$$
Nn(x) = f(x_0) + f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)+\dots+f[x_0,x_1,\dots,x_n](x-x_0)(x-x_1)\dots(x-x_{n-1}) \\
其中f[x_0,x_1]称作一阶差商，f[x_0,x_1]=\frac{f(x_1)-f(x_0)}{x_1-x_0} \\
同理f[x_0,x_1,x_2]称作二阶差商，f[x_0,x_1,x_2]=\frac{f[x_1,x_2]-f[x_0,x_1]}{x_2-x_0} \\
进一步递推的可以得到f[x_0,x_1,\dots,x_n]=\frac{f[x_1,x_2,\dots,x_n]-f[x_0,x_1,\dots,x_{n-1}]}{x_n-x_0}\\

多项式函数的差商计算，最大次系数为a的n次多项式函数的n阶差商=a,n+1阶差商为0\\
依据，n阶差商与n阶导数的关系：f[x_0,x_1,\cdots,x_n]=\frac{f^{(n)}(\xi)}{n!}\quad\xi\in[a,b]
$$

对于此类题目。一般先做出差商表，再进行计算就比较简单

**Newton插值法例题**

|  k   | x~k~ | f(x~k~) | f[x~k-1~,x~k~] | f[x~k-2~,x~k-1~,x~k~] | f[x~k-3~,x~k-2~,x~k-1~,x~k~] |
| :--: | :--: | :-----: | :------------: | :-------------------: | :--------------------------: |
|  0   |  0   |  **3**  |                |                       |                              |
|  1   |  1   |    3    |     **0**      |                       |                              |
|  2   | 3/2  |  13/4   |      1/2       |        **1/3**        |                              |
|  3   |  2   |   5/3   |     -19/6      |         -11/3         |            **-2**            |

根据差商表的对角线值即为所求插值公式所需值

该四点三次Newton插值多项式即为
$$
N_3(x)&=&f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)+f[x_0,x_1,x_2,x_3](x-x_0)(x-x_1)(x-x_2)\\
&=&3+0(x-0)+\frac{1}{3}(x-0)(x-1)+(-2)(x-0)(x-1)(x-\frac{3}{2}) \\
&=&3+(x^2-x)(\frac{10}{3}-2x)\\
&=&-2x^3+\frac{16}{3}x^2-\frac{10}{3}x+3
$$

### Hermite插值

Hermite插值中不仅要求函数值相同，还会要求导数值相等，与前面一致，n+1个条件可以推的n次多项式唯一！

这里推荐一个用Newton插值公式来计算Hermite插值的方法，即将某点的导数值看作一个重节点条件，再引入重节点的差商公式来进行计算：

**重节点的差商公式**：
$$
f[\underbrace{x,x,\cdots,x}_{k+1}]=\lim_{x_0,x_1,\cdots,x_{k-1}\to x}f[x_0,x_1,\cdots,x_{k-1},x]=\frac{f^{(k)}(x)}{k!} \\
最常用的就是一点含有一阶导数值，那么就可以看作一个二重节点\\
计算其对应的差商时就有：f[x,x]=f'(x) \\
同理一点含有二阶导数值时，就为三重节点，就有：f[x,x,x]=\frac{f''(x)}{2!}
$$
使用重节点的思想，将Hermite插值转换为Newton插值计算差商

**例题**

求一个四次插值多项式H~4~(x)，条件如下：

|  x   | f(x) | f'(x) | f''(x) |
| :--: | :--: | :---: | :----: |
|  0   |  -1  |  -2   |        |
|  1   |  0   |  10   |   40   |

按照重节点的思想，x=0为一个二重节点，x=1为一个三重节点

并可做如下的差商表：

| x~k~ | f(x~k~) |      一阶差商       |       二阶差商        |     三阶差商     |      四阶差商      |
| :--: | :-----: | :-----------------: | :-------------------: | :--------------: | :----------------: |
|  0   | **-1**  |                     |                       |                  |                    |
|  0   |   -1    | **f[0,0]=f'(0)=-2** |                       |                  |                    |
|  1   |    0    |      f[0,1]=1       |    **f[0,0,1]=3**     |                  |                    |
|  1   |    0    |   f[1,1]=f'(1)=10   |      f[0,1,1]=9       | **f[0,0,1,1]=6** |                    |
|  1   |    0    |   f[1,1]=f'(1)=10   | f[1,1,1]=f''(1)=40/2! |  f[0,1,1,1]=11   | **f[0,0,1,1,1]=5** |

通过差商表，便可十分轻易写处对应的插值公式为：
$$
H_4(x)&=&f(0)+f[0,0](x-0)+f[0,0,1](x-0)^2+f[0,0,1,1](x-0)^2(x-1)+f[0,0,1,1,1](x-0)^2(x-1)^2\\
&=&-1+(-2)x+3x^2+6x^2(x-1)+5x^2(x-1)^2\\
&=&5x^4-4x^4+2x^2-2x-1
$$
通过上面的重节点处理方法下，所有的Hermite插值计算，均可以转换为Newton插值计算

## 考点3--插值余项与插值误差估计

### 插值余项

对于任意的插值方法，它们的插值余项是可以表示为同一种形式的
$$
总结来说，插值余项的形式即为，若插值为n次多项式，插值余项R_n(x) \\
第一项形式固定 :\frac{f^{(n+1)}(\xi)}{(n+1)!} \\
第二项则与插值节点x_i有关(Hermite插值中看作重节点！): \prod_{i=0}^{n}(x-x_i) \\
二者结合可得R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\prod_{i=0}^{n}(x-x_i) \\
$$

### 插值误差的估计

插值误差的估计，本质上还是考察插值余项，不过是将插值余项R~n~（x)实例化的一个过程！
$$
对于插值n次多项式，我们有插值余项R_n(x)=\frac{f^{(n+1)}(\xi_x)}{(n+1)!}\prod_{i=0}^{n}(x-x_i) \\
我们用将\xi_x用最大值来替代进行误差上限估计:|f^{(n+1)}(x)|\le M_{n+1}\space \\
进一步通过均值不等式:a_1\cdot a_2\cdots a_n\le (\frac{a_1+a_2+\cdots+a_n}{n})^{n} \\
\prod_{i=0}^{n}(x-x_i)\le(\frac{\sum_{i=0}^{n}(x-x_i)}{n+1})^{n+1}=(x-\frac{\sum_{i=0}^{n}x_i}{n+1})^{n+1}\le \max_{x\in x_i}(x-\frac{\sum_{i=0}^{n}x_i}{n+1})^{n+1}\\
综上可得插值误差的估计值|Rn(x)|\le \frac{M_{n+1}}{(n+1)!}\max_{x\in x_i}(x-\frac{\sum_{i=0}^{n}x_i}{n+1})^{n+1}
$$
**例题**

若p(x)是f(x)=e^x-2^在节点0，0.1，0.2，……，0.9，1处的10次插值多项式，试估计该插值多项式在[0,1]上的插值误差。

分析：不难看出本题中的插值多项式是一个11点10次的插值多项式，并且没有重节点，因此根据前面**插值余项**的学习，很容易写出该插值多项式的插值余项为：
$$
R_{10}(x)=\frac{f^{(11)}(\xi)}{(n+1)!}(x-0)(x-0.1)\cdots(x-0.9)(x-1)
$$
再根据前面**插值误差的估计**
$$
我们接下来要计算的就是f^{(11)}(x)在[0,1]上的最大值M_{n+1}\\
f^{(11)}(x)=e^{x-2},显然M_{11}=\max_{x\in[0,1]}f^{(11)}(x)=f^{(11)}(1)=e^{-1} \\
接着根据均值不等式我们:\\
(x-0)(x-0.1)\cdots(x-0.9)(x-1)\le(x-\frac{0.1+0,2+\cdots+0.9+1}{11})^{11}=(x-0,5)^{11} \\
进一步的 (x-0.5)^{11}\le \max_{x\in[0,1]}(x-0.5)^{11}=0.5^{11} \\
综上|R_{10}(x)|\le \frac{M_{11}}{11!}0.5^{11}=\frac{e^{-1}0.5^{11}}{11!}
$$
